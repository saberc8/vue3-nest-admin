var z=Object.defineProperty;var I=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var O=(e,s,o)=>s in e?z(e,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[s]=o,y=(e,s)=>{for(var o in s||(s={}))U.call(s,o)&&O(e,o,s[o]);if(I)for(var o of I(s))A.call(s,o)&&O(e,o,s[o]);return e};var k=(e,s,o)=>new Promise((i,m)=>{var p=a=>{try{r(o.next(a))}catch(_){m(_)}},l=a=>{try{r(o.throw(a))}catch(_){m(_)}},r=a=>a.done?i(a.value):Promise.resolve(a.value).then(p,l);r((o=o.apply(e,s)).next())});import{r as h,f,u as t,d as E,g as K,h as V,a as d,j as D,v as Q,o as W,k as j,w as u,e as c,i as q,l as S,m as $,n as H,_ as J}from"./index-89053c67.js";var C=(e=>(e[e.LOGIN=0]="LOGIN",e[e.REGISTER=1]="REGISTER",e[e.RESET_PASSWORD=2]="RESET_PASSWORD",e[e.MOBILE=3]="MOBILE",e[e.QR_CODE=4]="QR_CODE",e))(C||{});const x=h(0);function X(){function e(i){x.value=i}const s=f(()=>x.value);function o(){e(0)}return{setLoginState:e,getLoginState:s,handleBackLogin:o}}function Y(e){function s(){return k(this,null,function*(){const o=t(e);return o?yield o.validate():void 0})}return{validForm:s}}function Z(e){const s=f(()=>F("请输入账号")),o=f(()=>F("请输入密码")),i=f(()=>F("请输入验证码")),m=f(()=>F("请输入手机号"));return{getFormRules:f(()=>{const l=t(s),r=t(o),a=t(i),_=t(m),g={sms:a,mobile:_};switch(t(x)){case 1:return y({account:l,password:r,confirmPassword:[{validator:validateConfirmPassword(e==null?void 0:e.password),trigger:"change"}],policy:[{validator:validatePolicy,trigger:"change"}]},g);case 2:return y({account:l},g);case 3:return g;default:return{account:l,password:r}}})}}function F(e){return[{required:!0,message:e,trigger:"change"}]}const ee=E({__name:"LoginForm",setup(e){const{notification:s}=H(),o=K(),{getLoginState:i}=X(),{getFormRules:m}=Z(),p=h(),l=h(!1),r=h(!1),a=V({account:"admin",password:"123456"}),{validForm:_}=Y(p),g=f(()=>t(i)===C.LOGIN);function b(){return k(this,null,function*(){const w=yield _();if(w)try{l.value=!0;const n=yield o.login({password:w.password,username:w.account});n&&s.success({message:"登录成功",description:`用户名: ${n.nickname}`,duration:3})}catch(n){}finally{l.value=!1}})}return(w,n)=>{const P=d("a-input"),R=d("a-form-item"),T=d("a-input-password"),B=d("a-checkbox"),G=d("a-col"),L=d("a-row"),M=d("a-button"),N=d("a-form");return D((W(),j(N,{class:"login-form",model:t(a),rules:t(m),ref_key:"formRef",ref:p,onKeypress:$(b,["enter"])},{default:u(()=>[c(R,{name:"account",class:"enter-x"},{default:u(()=>[c(P,{size:"large",value:t(a).account,"onUpdate:value":n[0]||(n[0]=v=>t(a).account=v),placeholder:"账号",class:"fix-auto-fill"},null,8,["value"])]),_:1}),c(R,{name:"password",class:"enter-x"},{default:u(()=>[c(T,{size:"large",visibilityToggle:"",value:t(a).password,"onUpdate:value":n[1]||(n[1]=v=>t(a).password=v),placeholder:"密码"},null,8,["value"])]),_:1}),c(L,{class:"enter-x"},{default:u(()=>[c(G,{span:12},{default:u(()=>[c(R,null,{default:u(()=>[c(B,{checked:t(r),"onUpdate:checked":n[2]||(n[2]=v=>q(r)?r.value=v:null),size:"small"},{default:u(()=>[S(" 记住我 ")]),_:1},8,["checked"])]),_:1})]),_:1})]),_:1}),c(R,{class:"enter-x"},{default:u(()=>[c(M,{type:"primary",size:"large",block:"",onClick:b,loading:t(l)},{default:u(()=>[S(" 登录 ")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules","onKeypress"])),[[Q,t(g)]])}}});const te=J(ee,[["__scopeId","data-v-3999f11a"]]);export{te as default};
